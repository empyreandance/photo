<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portraits - Mobile Optimized</title>
    <style>
        /* -------------------- Global Styles -------------------- */
        html,body{
            margin:0;
            padding:0;
            background:#000;
            color:#eee;
            font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
            -webkit-font-smoothing:antialiased;
        }
        a{color:#eee;text-decoration:none;}
        a:hover{opacity:.7;}
        img{border:0;}

        /* Container */
        .container{
            max-width:1400px;
            margin:0 auto;
            padding:40px 30px 0;
        }
        header{text-align:center;}
        header h1{margin:0;font-size:2.4em;font-weight:300;letter-spacing:1px;}
        .subtitle{color:#888;font-size:1.1em;}

        nav{margin:40px 0;text-align:center;}
        nav a{color:#ccc;margin:0 15px;font-size:1.1em;padding:5px 0;border-bottom:2px solid transparent;transition:color .3s ease,border-bottom-color .3s ease;display:inline-block;}
        nav a:hover,nav a.active{color:#fff;border-bottom-color:#fff;}

        .content{opacity:0;transform:translateY(20px);animation:fadeIn .6s ease forwards;}
        @keyframes fadeIn{to{opacity:1;transform:none;}}

        /* -------------------- Optimized Grid -------------------- */
        .photo-grid{
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .photo-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .photo-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }

        .photo-item{
            overflow:hidden;
            border-radius:8px;
            background:#111;
            cursor:pointer;
            transition:all .3s ease;
            border:1px solid #222;
            position: relative;
            min-height: 300px;
        }
        
        .photo-item:hover{
            transform:translateY(-5px);
            box-shadow:0 10px 30px rgba(0,0,0,.5);
            border-color:#444;
        }
        
        .photo-item img{
            width:100%;
            height:auto;
            display:block;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .photo-item img.loaded {
            opacity: 1;
        }

        /* Intersection Observer placeholder */
        .photo-placeholder{
            width: 100%;
            height: 300px;
            background: linear-gradient(90deg,#1a1a1a 25%,#222 50%,#1a1a1a 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.9em;
        }

        @keyframes loading{
            0%{background-position:200% 0;}
            100%{background-position:-200% 0;}
        }

        /* Load more button */
        .load-more{
            text-align: center;
            margin: 40px 0;
        }
        
        .load-more button{
            background: #333;
            color: #fff;
            border: 1px solid #555;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .load-more button:hover{
            background: #444;
            border-color: #666;
        }
        
        .load-more button:disabled{
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loading / Error */
        .loading-indicator{text-align:center;padding:20px;color:#666;font-size:.9em;}
        .error-message{color:#ff6b6b;text-align:center;padding:20px;display:none;}

        /* -------------------- Lightbox -------------------- */
        .lightbox{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:2000;cursor:pointer;}
        .lightbox-content{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:20px;}
        .lightbox img{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;cursor:default;}
        .lightbox-nav{position:fixed;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.1);border:none;color:#fff;font-size:3em;padding:20px 15px;cursor:pointer;transition:background .3s ease;font-weight:300;z-index:2001;border-radius:4px;}
        .lightbox-nav:hover{background:rgba(255,255,255,.2);} 
        .lightbox-prev{left:20px;}
        .lightbox-next{right:20px;}
        .lightbox-close{position:fixed;top:20px;right:30px;background:none;border:none;color:#fff;font-size:3em;cursor:pointer;transition:transform .3s ease;font-weight:300;z-index:2001;}
        .lightbox-close:hover{transform:scale(1.1);}

        footer{text-align:center;padding:40px 0;color:#666;font-size:.9em;border-top:1px solid #222;margin-top:100px;}

        /* -------------------- Responsive Tweaks -------------------- */
        @media (max-width:1024px){nav a{margin:0 10px;font-size:1em;}}
        @media (max-width:768px){
            h1{font-size:2em;}
            nav a{margin:0 8px;font-size:.95em;}
            .container{padding:15px;}
            .lightbox-content{padding:10px;}
            .lightbox-nav{padding:15px 10px;font-size:2.5em;}
            .lightbox-prev{left:10px;}
            .lightbox-next{right:10px;}
            .lightbox-close{top:10px;right:15px;font-size:2em;}
        }
    </style>
</head>
<body oncontextmenu="return false;">
    <div class="container">
        <header>
            <h1><a href="https://www.alexcooke.co">Alex Cooke</a></h1>
            <p class="subtitle">Photography</p>
        </header>

        <nav>
            <a href="aerial.html">Aerial</a>
            <a href="baseball.html">Baseball</a>
            <a href="events.html">Events</a>
            <a href="horses.html">Horses</a>
            <a href="landscapes.html">Landscapes</a>
            <a href="portraits.html" class="active">Portraits</a>
            <a href="weddings.html">Weddings</a>
            <a href="index.html">About</a>
        </nav>

        <div class="content">
            <div class="loading-indicator" id="loadingIndicator" style="display:none;">Loading photos...</div>
            <div class="error-message" id="errorMessage"></div>
            <div class="photo-grid" id="photoGrid"></div>
            <div class="load-more" id="loadMoreContainer" style="display:none;">
                <button id="loadMoreBtn" onclick="loadMoreImages()">Load More Photos</button>
            </div>
        </div>

        <footer>
            <p>
                <a href="contact.html" style="color:#999;text-decoration:none;border-bottom:1px solid #444;transition:all .3s ease;">Contact Me</a>
                <span style="margin:0 20px;color:#444;">•</span>
                &copy; 2025 Alex Cooke. All rights reserved.
            </p>
        </footer>
    </div>

    <!-- --------------- Lightbox --------------- -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox(event)">
        <div class="lightbox-content">
            <img id="lightboxImage" src="" alt="">
        </div>
        <button class="lightbox-nav lightbox-prev" onclick="navigateLightbox(-1)">‹</button>
        <button class="lightbox-nav lightbox-next" onclick="navigateLightbox(1)">›</button>
        <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
    </div>

    <script>
        /* -------------------- Photo Configuration -------------------- */
        const photos = [
            "portraits-84.jpg","portraits-78.jpg","portraits-62.jpg","portraits-39.jpg","portraits-72.jpg","portraits-47.jpg","portraits-28.jpg","portraits-15.jpg","portraits-8.jpg","portraits-87.jpg","portraits-68.jpg","portraits-4.jpg","portraits-80.jpg","portraits-63.jpg","portraits-42.jpg","portraits-40.jpg","portraits-22.jpg","portraits-90.jpg","portraits-32.jpg","portraits-5.jpg","portraits-45.jpg","portraits-11.jpg","portraits-50.jpg","portraits-24.jpg","portraits-46.jpg","portraits-58.jpg","portraits-17.jpg","portraits-59.jpg","portraits-23.jpg","portraits-14.jpg","portraits-77.jpg","portraits-57.jpg","portraits-44.jpg","portraits-9.jpg","portraits-12.jpg","portraits-51.jpg","portraits-83.jpg","portraits-34.jpg","portraits-41.jpg","portraits-67.jpg","portraits-93.jpg","portraits-91.jpg","portraits-82.jpg","portraits-88.jpg","portraits-37.jpg","portraits-65.jpg","portraits-89.jpg","portraits-30.jpg","portraits-75.jpg","portraits-66.jpg","portraits-71.jpg","portraits-18.jpg","portraits-2.jpg","portraits-20.jpg","portraits-56.jpg","portraits-16.jpg","portraits-36.jpg","portraits-35.jpg","portraits-7.jpg","portraits-74.jpg","portraits-10.jpg","portraits-21.jpg","portraits-26.jpg","portraits-61.jpg","portraits-43.jpg","portraits-55.jpg","portraits-48.jpg","portraits-70.jpg","portraits-52.jpg","portraits-85.jpg","portraits-19.jpg","portraits-29.jpg","portraits-81.jpg","portraits-3.jpg","portraits-86.jpg","portraits-92.jpg","portraits-60.jpg","portraits-25.jpg","portraits-76.jpg","portraits-27.jpg","portraits-31.jpg","portraits-49.jpg","portraits-73.jpg","portraits-54.jpg","portraits-13.jpg","portraits-33.jpg","portraits-69.jpg","portraits-38.jpg","portraits-6.jpg","portraits-53.jpg","portraits-64.jpg","portraits-1.jpg","portraits-79.jpg"
        ];
        const photoFolder = "portraits";

        /* -------------------- Mobile-Optimized Loading -------------------- */
        let currentPhotoIndex = 0;
        let loadedImageCount = 0;
        let imagesPerLoad = 12; // Load 12 images at a time
        let currentLoadIndex = 0;
        let observer = null;

        // Detect mobile device
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
        
        // Adjust load count for mobile
        if (isMobile) {
            imagesPerLoad = 8; // Fewer images on mobile
        }

        /* -------------------- Intersection Observer for Lazy Loading -------------------- */
        function createIntersectionObserver() {
            if ('IntersectionObserver' in window) {
                observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const src = img.dataset.src;
                            if (src) {
                                img.src = src;
                                img.onload = () => {
                                    img.classList.add('loaded');
                                };
                                img.removeAttribute('data-src');
                                observer.unobserve(img);
                            }
                        }
                    });
                }, {
                    rootMargin: '50px'
                });
            }
        }

        /* -------------------- Load Photos in Batches -------------------- */
        function loadPhotos() {
            const photoGrid = document.getElementById("photoGrid");
            if (!photoGrid) {
                console.error("Photo grid element not found!");
                return;
            }
            
            createIntersectionObserver();
            loadBatch();
        }

        function loadBatch() {
            const photoGrid = document.getElementById("photoGrid");
            const loadingIndicator = document.getElementById("loadingIndicator");
            const loadMoreContainer = document.getElementById("loadMoreContainer");
            const loadMoreBtn = document.getElementById("loadMoreBtn");
            
            // Show loading indicator
            if (currentLoadIndex === 0) {
                loadingIndicator.style.display = "block";
            }
            
            const endIndex = Math.min(currentLoadIndex + imagesPerLoad, photos.length);
            
            for (let i = currentLoadIndex; i < endIndex; i++) {
                createPhotoItem(photos[i], i);
            }
            
            currentLoadIndex = endIndex;
            
            // Hide loading indicator after first batch
            if (loadingIndicator.style.display === "block") {
                setTimeout(() => {
                    loadingIndicator.style.display = "none";
                }, 500);
            }
            
            // Show/hide load more button
            if (currentLoadIndex < photos.length) {
                loadMoreContainer.style.display = "block";
                loadMoreBtn.disabled = false;
                loadMoreBtn.textContent = `Load More Photos (${photos.length - currentLoadIndex} remaining)`;
            } else {
                loadMoreContainer.style.display = "none";
            }
        }

        function createPhotoItem(filename, index) {
            const photoGrid = document.getElementById("photoGrid");
            
            const item = document.createElement("div");
            item.className = "photo-item";
            item.onclick = () => openLightbox(index);
            
            const img = document.createElement("img");
            img.alt = `Portrait ${index + 1}`;
            
            // Use intersection observer for lazy loading
            if (observer) {
                img.dataset.src = `${photoFolder}/${filename}`;
                observer.observe(img);
            } else {
                // Fallback for browsers without IntersectionObserver
                img.src = `${photoFolder}/${filename}`;
                img.onload = () => {
                    img.classList.add('loaded');
                };
            }
            
            img.onerror = () => {
                const placeholder = document.createElement("div");
                placeholder.className = "photo-placeholder";
                placeholder.textContent = "Image not found";
                item.appendChild(placeholder);
            };
            
            item.appendChild(img);
            photoGrid.appendChild(item);
            
            loadedImageCount++;
        }

        function loadMoreImages() {
            const loadMoreBtn = document.getElementById("loadMoreBtn");
            loadMoreBtn.disabled = true;
            loadMoreBtn.textContent = "Loading...";
            
            // Small delay to show loading state
            setTimeout(() => {
                loadBatch();
            }, 300);
        }

        /* -------------------- Optimized Resize Handler -------------------- */
        let resizeTimeout;
        function handleResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // Minimal resize handling - CSS Grid handles most of the work
                console.log('Resize handled');
            }, 250);
        }

        window.addEventListener("resize", handleResize);

        /* -------------------- Lightbox -------------------- */
        function openLightbox(i) {
            currentPhotoIndex = i;
            const lightbox = document.getElementById("lightbox");
            const lightboxImage = document.getElementById("lightboxImage");
            
            lightboxImage.src = `${photoFolder}/${photos[i]}`;
            lightbox.style.display = "block";
            document.body.style.overflow = "hidden";
        }

        function closeLightbox(e) {
            if (e && e.target !== e.currentTarget && !e.target.classList.contains("lightbox-close")) return;
            
            const lightbox = document.getElementById("lightbox");
            lightbox.style.display = "none";
            document.body.style.overflow = "auto";
        }

        function navigateLightbox(dir) {
            currentPhotoIndex += dir;
            
            if (currentPhotoIndex < 0) {
                currentPhotoIndex = photos.length - 1;
            } else if (currentPhotoIndex >= photos.length) {
                currentPhotoIndex = 0;
            }
            
            const lightboxImage = document.getElementById("lightboxImage");
            lightboxImage.src = `${photoFolder}/${photos[currentPhotoIndex]}`;
            
            if (event) event.stopPropagation();
        }

        // Keyboard navigation
        document.addEventListener("keydown", (e) => {
            const lightbox = document.getElementById("lightbox");
            if (lightbox.style.display === "block") {
                if (e.key === "ArrowLeft") navigateLightbox(-1);
                if (e.key === "ArrowRight") navigateLightbox(1);
                if (e.key === "Escape") closeLightbox();
            }
        });

        // Disable drag
        document.addEventListener("dragstart", (e) => {
            if (e.target.tagName === "IMG") e.preventDefault();
        });

        /* -------------------- Memory Management -------------------- */
        // Clean up on page unload
        window.addEventListener('beforeunload', () => {
            if (observer) {
                observer.disconnect();
            }
        });

        /* -------------------- Initialize -------------------- */
        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", loadPhotos);
        } else {
            loadPhotos();
        }
    </script>
</body>
</html>